import{_ as ue}from"./DpvUxtYC.js";import{g as _e,H as me,G as pe,r as p,S as E,h as fe,i as he,I as $,c as u,B as ve,a6 as xe,a as e,b as s,F as I,x as T,j as A,w as i,n as _,m as x,s as ge,o as l,t as c,v as z,d as h,E as ye,y as be}from"./BSKzHnPj.js";import{_ as ke}from"./dSNV757c.js";import{_ as we}from"./pQbWsUYk.js";import{_ as Ce}from"./BRXwIosz.js";import{_ as Fe}from"./KX0IhSIY.js";import{P as De}from"./DO5yl_m3.js";import{_ as Se}from"./CIZVXV85.js";import{_ as H}from"./HWga6m1v.js";import{u as $e}from"./Ck3765b6.js";import{u as Oe}from"./CudloQyO.js";import"./BkdCv88K.js";import"./yf0Evo6_.js";import"./BgAKsO_4.js";import"./Du0g8VFZ.js";import"./Bt8Cigau.js";const je={class:"w-100 flex flex-col items-center"},Ue={class:"flex justify-between items-stretch w-10/12 my-16 gap-16 px-8 pt-16"},Pe={class:"w-2/12"},Ie=e("h6",{class:"font-semibold"},"Client Dashboard",-1),Te={class:"flex flex-col items-start mt-4"},ze={class:"text-md text-primary"},Me={key:0,class:"w-10/12"},Ne={class:"flex gap-2 items-center mb-3"},Be=e("h6",{class:"font-semibold"},"Detail Order",-1),Le={class:"flex justify-between items-center"},Re={class:"flex items-center gap-2 capitalize"},Ve={class:"font-semibold"},Ee={class:"flex justify-between items-center gap-2"},Ae={class:"capitalize"},He={class:"flex gap-3 justify-between items-center px-2"},Ye={class:"flex gap-3 w-7/12"},Je={class:"flex flex-col gap-1"},We={class:"font-semibold text-primary"},qe={class:""},Ge={class:"text-sm text-gray-700"},Ke=e("br",null,null,-1),Qe={class:"text-sm text-gray-700"},Xe={key:0},Ze={key:0,class:"mt-4 flex flex-col items-end gap-2"},et=e("span",{class:"font-semibold text-sm pb-1"}," Download Result ",-1),tt={key:1,class:"mt-4 flex flex-col items-end gap-2"},st=e("span",{class:"font-semibold text-sm pb-1"},"Meeting Link",-1),at={key:1,class:"flex flex-col text-right items-end"},ot=e("span",{class:"font-thin text-primary text-sm"}," Amount to be transfer : ",-1),nt={class:"font-semibold text-primary text-lg my-1"},lt={class:"font-thin text-primary text-sm"},it={class:"font-bold text-primary text-md text-xl py-2 flex gap-2 items-center uppercase"},rt={class:"font-thin text-primary text-sm mb-2"},ct={key:2,class:"flex flex-col text-right items-end"},dt=e("span",{class:"font-semibold text-xl pb-2"},"Work In Progress",-1),ut=e("p",{class:"w-7/12 text-gray-600 text-sm"}," Your order has been received and is now being processed. Thank you for your trust in using our services. ",-1),_t={key:0,class:"mt-4 flex flex-col gap-2"},mt=e("span",{class:"font-semibold text-sm pb-1"},"Meeting Link",-1),pt={key:0,class:"mt-6"},ft=e("h6",{class:"font-semibold mb-2"},"Discussions",-1),ht={key:0,class:"pb-4"},vt={class:"flex gap-2 items-center"},xt={class:"flex flex-col items-start gap-1"},gt={class:"font-semibold"},yt=e("span",{class:"capitalize"}," Faciliator ",-1),bt={class:"flex text-gray-700 my-3 text-sm"},kt={class:"text-gray-700 text-sm"},wt={key:1,class:"pb-4"},Ct={class:"flex gap-2 items-center"},Ft=e("div",{class:"flex flex-col items-start gap-1"},[e("span",{class:"font-semibold text-primary"}," You ")],-1),Dt={class:"flex text-gray-700 my-3 text-sm"},St={class:"text-gray-700 text-sm"},$t={class:"flex justify-end border-t border-1 pt-2 gap-2"},Jt={__name:"[id]",setup(Ot){const g=_e(),M=me(),N=pe(),{getDetailOrder:Y,updateMyOrder:B}=$e(),{getSettingBank:J}=Oe(),W=[{key:"order-history",label:"Order History",icon:"user-circle",scope:"all"}],q=p({title:"",content:"",confirmText:"",cancelText:"",callback:null}),F=p(!0),G=p(!1),O=p(!1),D=p("order-history"),f=p({fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}),k=p({bank_name:"",bank_account:"",bank_account_name:""}),L=p([]),j=p(3),w=p([]),y=p({user:{fullname:"You",photo:"/images/avatar.jpg"},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}),K=E(()=>{if(!f.value)return[];const t=f.value.is_admin??!1,o=f.value.is_facilitator??!1;return W.filter(d=>d.scope==="all"||d.scope==="admin"&&t||d.scope==="merchant"&&o)}),Q=E(()=>w.value.slice(-(j.value??3))),R=t=>{switch(t){case"completed":return{color:"green",text:"Completed"};case"paid":return{color:"blue",text:"In Progress"};case"pending":return{color:"violet",text:"Pending"};case"waitingpaid":return{color:"orange",text:"Waiting Payment & Verification"};case"failed":return{color:"red",text:"Failed"};default:return{color:"gray",text:"Unknown"}}},X=t=>{navigator.clipboard.writeText(t),g.add({title:"Copied!",color:"green",icon:"i-heroicons-check-circle",description:"No Rekening copied to clipboard!"})},C=t=>{window.open(t,"_blank")},Z=t=>{N.push(t)},V=t=>{const o=new Date,d=new Date(t),r=Math.floor((o-d)/1e3),m={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(const b in m){const v=Math.floor(r/m[b]);if(v>=1)return v===1?`${v} ${b} ago`:`${v} ${b}s ago`}return"just now"},ee=()=>{console.log("Logging out..."),$("token").value=null,f.value={fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}},te=t=>{try{return JSON.parse(t)}catch{return t}},se=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t),U=async()=>{const t=M.params.id;try{const{data:o}=await Y(t);L.value=[o.data.order],w.value=te(o.data.order.comment_json)??[]}catch(o){console.error("Fetching orders failed:",o)}},ae=t=>{console.log("File uploaded:",t),y.value.file_url=t};fe(()=>D.value,t=>{t==="service"&&$("token").value.user.merchant_status==="pending"&&N.push({name:"my-merchant-status"})});const oe=async()=>{try{f.value=$("token").value.user||null,y.value.user={fullname:f.value.fullname,photo:f.value.photo}}catch(t){console.error("Fetching user failed:",t)}},ne=async(t,o)=>{const d=w.value??[];if(!o.message&&o.file_url&&(o.message="Here I attached a file."),!o.message&&!o.file_url){g.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Comment message is required!"});return}d.push(o);try{const{data:r}=await B(t,{comment_json:d});g.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Order updated successfully!"}),await U(),y.value={user:{fullname:f.value.fullname,photo:f.value.photo},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}}catch(r){console.error("Updating order failed:",r),g.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Failed to update order!"})}},le=async t=>{const o=M.params.id;try{const{data:d}=await B(o,{payment_file_url:t});g.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Order updated successfully!"}),await U()}catch(d){console.error("Updating order failed:",d),g.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Failed to update order!"})}},ie=async()=>{try{const{data:t}=await J();k.value=t.data.setting}catch(t){console.error("Error fetching bank data:",t)}finally{F.value=!1}};return he(async()=>{$("token").value&&(await oe(),await U(),await ie()),F.value=!1,window.scrollTo({top:0,behavior:"smooth"})}),(t,o)=>{const d=ue,r=ge,m=ye,b=ke,v=be,S=we,re=Ce,ce=Fe;return l(),u("div",null,[ve(e("div",je,[s(Se,{user:f.value,onLogout:ee,class:"w-full"},null,8,["user"]),e("div",Ue,[e("div",Pe,[Ie,e("div",Te,[(l(!0),u(I,null,T(A(K),(a,P)=>(l(),x(r,{key:P,block:"",class:z(["py-3 px-3.5 flex justify-start bg-white hover:bg-[#FDF1EE] shadow-none",D.value===a.key?"bg-[#FDF1EE]":"bg-white"]),onClick:n=>D.value=a.key},{default:i(()=>[s(d,{name:a.icon,class:"text-2xl text-primary"},null,8,["name"]),e("span",ze,c(a.label),1)]),_:2},1032,["class","onClick"]))),128))])]),D.value==="order-history"?(l(),u("div",Me,[e("div",Ne,[s(r,{variant:"link",onClick:o[0]||(o[0]=a=>Z({name:"my-client-orders"}))},{default:i(()=>[s(d,{name:"chevron-left"})]),_:1}),Be]),(l(!0),u(I,null,T(L.value,(a,P)=>(l(),x(S,{key:P,ui:{header:{padding:"px-4 py-2 sm:px-3"},body:{padding:"px-4 py-0  sm:p-3"}},class:"p-2"},{header:i(()=>[e("div",Le,[e("div",Re,[s(m,{name:"i-heroicons-language"}),e("span",Ve,c(a.merchant.type),1)]),e("div",Ee,[s(b,{variant:"soft",color:R(a.order_status).color},{default:i(()=>[e("span",Ae,c(R(a.order_status).text),1)]),_:2},1032,["color"]),s(r,{variant:"link"},{default:i(()=>[s(d,{name:"dots",class:"text-md text-primary"})]),_:1})])])]),default:i(()=>[e("div",He,[e("div",Ye,[e("div",Je,[s(v,{alt:a.merchant_user.fullname,src:a.merchant_user.photo,size:"xl",imgClass:"object-cover",class:"mb-2"},null,8,["alt","src"]),e("span",We,c(a.merchant_user.fullname),1),e("div",qe,[e("span",Ge,[h(c(a.service.name)+" Service ",1),Ke]),e("span",Qe," ("+c(a.language_source.name)+" - "+c(a.language_destination.name)+") ",1)])])]),a.order_status==="completed"?(l(),u("div",Xe,[a.result_file_url?(l(),u("div",Ze,[et,s(r,{color:"primary",class:"text-white",onClick:n=>C(a.result_file_url)},{default:i(()=>[s(m,{name:"i-heroicons-arrow-down-tray"}),h(" Download ")]),_:2},1032,["onClick"])])):_("",!0),a.meet_url?(l(),u("div",tt,[st,s(r,{color:"primary",onClick:n=>C(a.meet_url)},{default:i(()=>[s(m,{name:"i-heroicons-video-camera"}),h(" Open Meeting Url ")]),_:2},1032,["onClick"])])):_("",!0)])):_("",!0),a.order_status==="waitingpaid"?(l(),u("div",at,[ot,e("h6",nt,c(se(a.price)),1),e("span",lt,c(k.value.bank_account_name),1),e("h6",it,[h(c(k.value.bank_account)+" ("+c(k.value.bank)+") ",1),s(r,{size:"xs",variant:"outline",color:"blue",onClick:o[1]||(o[1]=n=>X(k.value.bank_account)),class:""},{default:i(()=>[s(d,{name:"copy",class:"text-lg"})]),_:1})]),e("span",rt,c(a.payment_file_url?"Re":"")+" Upload Proof of Payment ",1),O.value||!a.payment_file_url?(l(),x(H,{key:0,title:"Proof of Payment",accept:"*",center:!0,"max-size":"6291456",onFileUploaded:le})):_("",!0),!O.value&&a.payment_file_url?(l(),x(r,{key:1,color:"primary",class:"text-white",onClick:o[2]||(o[2]=n=>O.value=!0)},{default:i(()=>[s(m,{name:"i-heroicons-arrow-path"}),h(" Reupload ")]),_:1})):_("",!0)])):_("",!0),a.order_status==="paid"?(l(),u("div",ct,[dt,ut,a.meet_url?(l(),u("div",_t,[mt,s(r,{color:"primary",onClick:n=>C(a.meet_url)},{default:i(()=>[s(m,{name:"i-heroicons-video-camera"}),h(" Open Meeting Url ")]),_:2},1032,["onClick"])])):_("",!0)])):_("",!0)]),a.order_status==="paid"||a.order_status==="completed"?(l(),u("div",pt,[ft,j.value<w.value.length?(l(),x(r,{key:0,block:"",color:"primary",variant:"soft",class:"my-4 bg-blue-100 hover:bg-blue-200",onClick:o[3]||(o[3]=n=>j.value=w.value.length)},{default:i(()=>[s(m,{name:"i-heroicons-chat-bubble-oval-left-ellipsis"}),h(" Load Previous Comments ")]),_:1})):_("",!0),(l(!0),u(I,null,T(A(Q),n=>(l(),u("div",{key:n},[n.is_facilitator?(l(),u("div",ht,[s(S,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[e("div",vt,[s(v,{alt:n.user.fullname,src:n.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),e("div",xt,[e("span",gt,c(n.user.fullname),1),s(b,{variant:"soft",size:"xs",color:"blue"},{default:i(()=>[yt]),_:1})])]),e("div",bt,c(n.message),1),e("div",{class:z(["flex items-center",n.file_url?"justify-between":"justify-end"])},[n.file_url?(l(),x(r,{key:0,color:"green",variant:"soft",onClick:de=>C(n.file_url)},{default:i(()=>[s(m,{name:"i-heroicons-arrow-down-tray"}),h(" Attached File ")]),_:2},1032,["onClick"])):_("",!0),e("span",kt,c(V(new Date(n.time))),1)],2)]),_:2},1024)])):(l(),u("div",wt,[s(S,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-ful bg-blue-50"},{default:i(()=>[e("div",Ct,[s(v,{alt:n.user.fullname,src:n.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),Ft]),e("div",Dt,c(n.message),1),e("div",{class:z(["flex items-center",n.file_url?"justify-between":"justify-end"])},[n.file_url?(l(),x(r,{key:0,color:"green",variant:"soft",onClick:de=>C(n.file_url)},{default:i(()=>[s(m,{name:"i-heroicons-arrow-down-tray"}),h(" Attached File ")]),_:2},1032,["onClick"])):_("",!0),e("span",St,c(V(new Date(n.time),{addSuffix:!0})),1)],2)]),_:2},1024)]))]))),128)),s(S,{ui:{body:{base:"w-full",padding:"p-4 sm:p-2"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[s(re,{modelValue:y.value.message,"onUpdate:modelValue":o[4]||(o[4]=n=>y.value.message=n),class:"w-full mb-2",placeholder:"Add Comment...",variant:"none"},null,8,["modelValue"]),e("div",$t,[s(H,{"is-display-file":!1,accept:"*","max-size":"6291456",onFileUploaded:ae}),s(r,{color:"primary",onClick:n=>ne(a.id,y.value)},{default:i(()=>[s(m,{name:"i-heroicons-paper-airplane"}),h(" Send ")]),_:2},1032,["onClick"])])]),_:2},1024)])):_("",!0)]),_:2},1024))),128))])):_("",!0)])],512),[[xe,!F.value]]),F.value?(l(),x(De,{key:0})):_("",!0),s(ce,{isOpen:G.value,data:q.value},null,8,["isOpen","data"])])}}};export{Jt as default};
