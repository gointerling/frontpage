import{_ as q}from"./DvumrKrj.js";import{_ as H}from"./DGrq4f1g.js";import{_ as K}from"./G_bPuirm.js";import{_ as Q}from"./CDkhUFr5.js";import{g as R,r as i,h as W,i as G,c as b,b as o,w as s,j as J,o as p,a as n,t as l,k as X,d as Y,l as T,q as A,v as Z,s as ee}from"./BTSDszUJ.js";import{_ as te,a as ae}from"./BvyGCBkE.js";import{_ as ne}from"./veiQDZO_.js";import{_ as oe}from"./B9XNv89N.js";import{u as se}from"./ONxWT7kH.js";import"./ZcxYWiyP.js";import"./QMTWwr3q.js";import"./BzSNmRo5.js";import"./P5m1VOJr.js";import"./7ZUwepPQ.js";import"./BYiaUImn.js";const le={class:"w-full pt-0 p-6 flex flex-col gap-2"},ie={class:"flex gap-2"},ce={key:0,class:"flex flex-col gap-1 items-start capitalize"},re={class:"text-primary"},ue={key:1,class:"text-gray-300"},de={class:"text-primary"},me={class:"text-primary"},pe={class:"flex gap-3 items-center"},_e={class:"flex flex-col"},ge={class:"font-semibold text-primary"},fe={class:"text-sm text-gray-600"},ve={class:"flex gap-3 items-center"},xe={class:"flex flex-col"},he={class:"font-semibold text-primary"},ye={class:"text-sm text-gray-600"},be={class:"flex gap-1"},Pe="Transactions List",je={__name:"transactions",setup(ke){const{getAllOrders:I,updateClientOrderStatus:B}=se(),P=R(),k=i(!0),v=i(!1),C=i({title:"",message:"",callback:null});i([]);const U=i([]),d=i({label:"All",value:"all"}),_=i(""),m=i(1),x=i({page:1,totalPage:1,totalItems:0,itemsPerPage:10}),h=async()=>{try{await I({page:m.value,per_page:x.value.itemsPerPage,status:d.value.value==="all"?"":d.value.value,search:_.value}).then(a=>{U.value=a.data.data.orders.map((t,r)=>({no:r+1,service:{id:t.service.id,name:t.merchant.type,type:t.service.type},buyer:{id:t.user.id,fullname:t.user.fullname,email:t.user.email},facilitator:{id:t.merchant_user.id,fullname:t.merchant_user.fullname,email:t.merchant_user.email},languages:{language_source:t.language_source,language_destination:t.language_destination},price:t.price,status:t.order_status,actions:{id:t.id,status:t.order_status}}))})}catch(a){console.error("Error fetching merchant orders:",a)}finally{k.value=!1}};W(m,h);const y=()=>{y(m.value,d.value.value,_.value)},M=$(()=>{y()},500);function $(a,t,r){let c;return function(){const u=this,g=arguments,f=function(){c=null,a.apply(u,g)};clearTimeout(c),c=setTimeout(f,t)}}const w=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a),V=(a,t,r,c,u)=>{C.value={title:a,content:t,confirmText:r,cancelText:c,callback:u},v.value=!0},D=async a=>{await B(a,"paid").then(()=>{v.value=!1,P.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Payment status updated!"}),h()}).catch(t=>{console.error("Error updating payment status:",t),P.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-x-circle",description:"Error updating payment status!"})})},O=a=>{switch(a){case"completed":return{color:"green",text:"Completed"};case"paid":return{color:"blue",text:"In Progress By Facilitator"};case"pending":return{color:"violet",text:"Pending"};case"waitingpaid":return{color:"orange",text:"Waiting Payment"};case"failed":return{color:"red",text:"Failed"};default:return{color:"gray",text:"Unknown"}}};return G(()=>{h()}),(a,t)=>{const r=q,c=H,u=K,g=Q,f=Z,S=ee,z=te,N=ne,j=ae,E=J,F=oe;return p(),b("div",null,[o(E,{name:"admin"},{default:s(()=>[n("div",le,[o(u,{ui:{body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-4"}}},{default:s(()=>[n("h6",{class:"font-semibold"},l(Pe)),n("div",ie,[o(r,{options:[{label:"All",value:"all",color:"gray"},{label:"Verified",value:"verified",color:"blue"},{label:"Pending",value:"pending",color:"orange"}],modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),placeholder:"Pilih Status",by:"value","option-attribute":"label","search-attributes":["label"],onChange:y,class:"max-w-[180px]"},null,8,["modelValue"]),o(c,{icon:"i-heroicons-magnifying-glass-20-solid",size:"sm",color:"white",trailing:!1,placeholder:"Search Facilitator",modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),onInput:t[2]||(t[2]=e=>X(M)())},null,8,["modelValue"])])]),_:1}),o(u,{ui:{body:{base:"flex flex-col gap-4"}}},{default:s(()=>[o(N,{rows:U.value,loading:k.value,"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Loading..."}},{"service-data":s(({row:e})=>[e.service?(p(),b("div",ce,[n("span",re,l(e.service.name)+" Service ",1),o(g,{variant:"soft",color:"orange",class:"capitalize"},{default:s(()=>[Y(l(e.service.type),1)]),_:2},1024)])):(p(),b("span",ue," Kosong "))]),"price-data":s(({row:e})=>[n("span",de,l(w(e.price)),1)]),"languages-data":s(({row:e})=>[n("span",me,l(e.languages.language_source.name)+" -> "+l(e.languages.language_destination.name),1)]),"buyer-data":s(({row:e})=>[n("div",pe,[o(f,{src:e.buyer.photo,alt:e.buyer.fullname,size:"sm",variant:"rounded-full",imgClass:"object-cover"},null,8,["src","alt"]),n("div",_e,[n("span",ge,l(e.buyer.fullname),1),n("span",fe,l(e.buyer.email),1)])])]),"facilitator-data":s(({row:e})=>[n("div",ve,[o(f,{src:e.facilitator.photo,alt:e.facilitator.fullname,size:"sm",variant:"rounded-full",imgClass:"object-cover"},null,8,["src","alt"]),n("div",xe,[n("span",he,l(e.facilitator.fullname),1),n("span",ye,l(e.facilitator.email),1)])])]),"status-data":s(({row:e})=>[o(g,{size:"xs",label:O(e.status).text,color:O(e.status).color,variant:"subtle",class:"capitalize"},null,8,["label","color"])]),"actions-data":s(({row:e})=>[n("div",be,[e.actions.status==="pending"?(p(),T(z,{key:0,text:"Accept Order"},{default:s(()=>[o(S,{icon:"i-heroicons-check",size:"2xs",color:"green",variant:"outline",ui:{rounded:"rounded-full"},square:"",onClick:L=>V("Hang On","Are you sure you want to deactivate this facilitator?","Deactivate","Cancel",()=>{a.updateUserStatus(e.user.id,"inactive")})},null,8,["onClick"])]),_:2},1024)):A("",!0),e.actions.status==="waitingpaid"?(p(),T(z,{key:1,text:"Verify Payment"},{default:s(()=>[o(S,{icon:"i-heroicons-check",size:"2xs",color:"blue",variant:"outline",ui:{rounded:"rounded-full"},square:"",onClick:L=>V("Hang On","Are you sure you want to accept this payment?","Accept Payment","Cancel",()=>{D(e.actions.id)})},null,8,["onClick"])]),_:2},1024)):A("",!0)])]),_:1},8,["rows","loading"]),o(j,{modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value=e),max:5,"page-count":x.value.itemsPerPage,total:x.value.totalPage},null,8,["modelValue","page-count","total"])]),_:1})])]),_:1}),o(F,{isOpen:v.value,data:C.value},null,8,["isOpen","data"])])}}};export{je as default};
