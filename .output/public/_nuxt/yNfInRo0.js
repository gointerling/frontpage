import{_ as ne}from"./CGyI2hQu.js";import{g as le,x as ie,L as re,r as f,D as A,h as ce,i as de,B as $,c as u,Y as ue,a2 as me,a as e,b as o,F as S,m as T,k as B,w as i,q as p,l as v,s as _e,o as l,t as c,n as U,d as g,a0 as fe,v as pe}from"./BTSDszUJ.js";import{_ as he}from"./CDkhUFr5.js";import{_ as ge}from"./G_bPuirm.js";import{_ as ve}from"./n_hcIHAQ.js";import{_ as xe}from"./B9XNv89N.js";import{P as ye}from"./BrzK7Ufc.js";import{_ as be}from"./B3n1l5Hg.js";import{_ as ke}from"./DueKQsIK.js";import{u as we}from"./ONxWT7kH.js";import"./7ZUwepPQ.js";import"./BYiaUImn.js";import"./ZcxYWiyP.js";import"./BzSNmRo5.js";import"./QMTWwr3q.js";import"./DRO6Gor9.js";const Ce={class:"w-100 flex flex-col items-center"},De={class:"flex justify-between items-stretch w-10/12 my-16 gap-16 px-8"},$e={class:"w-2/12"},Fe=e("h6",{class:"font-semibold"},"Client Dashboard",-1),je={class:"flex flex-col items-start mt-4"},Oe={class:"text-md text-primary"},Se={key:0,class:"w-10/12"},Te={class:"flex gap-2 items-center mb-3"},Ue=e("h6",{class:"font-semibold"},"Detail Order",-1),Ie={class:"flex justify-between items-center"},Ne={class:"flex items-center gap-2 capitalize"},ze={class:"font-semibold"},Me={class:"flex justify-between items-center gap-2"},Pe={class:"capitalize"},Ae={class:"flex gap-3 justify-between items-center px-2"},Be={class:"flex gap-3 w-7/12"},Le={class:"flex flex-col gap-1"},Ve={class:"font-semibold text-primary"},Ee={class:""},Re={class:"text-sm text-gray-700"},Ye=e("br",null,null,-1),qe={class:"text-sm text-gray-700"},He={key:1,class:"flex flex-col text-right"},Je=e("span",{class:"font-thin text-primary text-md"}," Amount to be transfer : ",-1),We={class:"font-semibold text-primary text-lg my-1"},Ge=e("span",{class:"font-thin text-primary text-md"}," Gointering Account ",-1),Ke={class:"font-bold text-primary text-md text-xl py-1 flex gap-2 items-center"},Qe=e("img",{src:"",alt:""},null,-1),Xe={key:2,class:"flex flex-col text-right items-end"},Ze=e("span",{class:"font-semibold text-xl pb-2"},"Work In Progress",-1),et=e("p",{class:"w-7/12 text-gray-600 text-sm"}," Your order has been received and is now being processed. Thank you for your trust in using our services. ",-1),tt={key:0,class:"mt-4 flex flex-col gap-2"},st=e("span",{class:"font-semibold text-sm pb-1"},"Meeting Link",-1),ot={class:"mt-6"},at=e("h6",{class:"font-semibold mb-2"},"Discussions",-1),nt={key:0,class:"pb-4"},lt={class:"flex gap-2 items-center"},it={class:"flex flex-col items-start gap-1"},rt={class:"font-semibold"},ct=e("span",{class:"capitalize"}," Faciliator ",-1),dt={class:"flex text-gray-700 my-3 text-sm"},ut={class:"text-gray-700 text-sm"},mt={key:1,class:"pb-4"},_t={class:"flex gap-2 items-center"},ft=e("div",{class:"flex flex-col items-start gap-1"},[e("span",{class:"font-semibold text-primary"}," You ")],-1),pt={class:"flex text-gray-700 my-3 text-sm"},ht={class:"text-gray-700 text-sm"},gt={class:"flex justify-end border-t border-1 pt-2 gap-2"},zt={__name:"[id]",setup(vt){const k=le(),L=ie(),I=re(),{getDetailOrder:V,updateMyOrder:E}=we(),R=[{key:"order-history",label:"Order History",icon:"user-circle",scope:"all"}],Y=f({title:"",content:"",confirmText:"",cancelText:"",callback:null}),F=f(!0),q=f(!1),w=f("order-history"),m=f({fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}),N=f([]),j=f(3),b=f([]),x=f({user:{fullname:"You",photo:"/images/avatar.jpg"},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}),H=A(()=>{if(!m.value)return[];const t=m.value.is_admin??!1,s=m.value.is_facilitator??!1;return R.filter(d=>d.scope==="all"||d.scope==="admin"&&t||d.scope==="merchant"&&s)}),J=A(()=>b.value.slice(-(j.value??3))),z=t=>{switch(t){case"completed":return{color:"green",text:"Completed"};case"paid":return{color:"blue",text:"In Progress"};case"pending":return{color:"violet",text:"Pending"};case"waitingpaid":return{color:"orange",text:"Waiting Payment"};case"failed":return{color:"red",text:"Failed"};default:return{color:"gray",text:"Unknown"}}},W=t=>{navigator.clipboard.writeText(t),k.add({title:"Copied!",color:"green",icon:"i-heroicons-check-circle",description:"No Rekening copied to clipboard!"})},C=t=>{window.open(t,"_blank")},G=t=>{I.push(t)},M=t=>{const s=new Date,d=new Date(t),r=Math.floor((s-d)/1e3),_={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};for(const y in _){const h=Math.floor(r/_[y]);if(h>=1)return h===1?`${h} ${y} ago`:`${h} ${y}s ago`}return"just now"},K=()=>{console.log("Logging out..."),$("token").value=null,m.value={fullname:"",photo:"",email:"",phone:"",address:"",role:"",personal_description:"",main_skills:[],additional_skills:[],is_admin:!1,is_facilitator:!1}},Q=t=>{try{return JSON.parse(t)}catch{return t}},X=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t),P=async()=>{const t=L.params.id;try{const{data:s}=await V(t);N.value=[s.data.order],console.log(s.data.order.comment_json),b.value=Q(s.data.order.comment_json)??[]}catch(s){console.error("Fetching orders failed:",s)}},Z=t=>{console.log("File uploaded:",t),x.value.file_url=t};ce(()=>w.value,t=>{t==="service"&&$("token").value.user.merchant_status==="pending"&&I.push({name:"my-merchant-status"})});const ee=async()=>{try{m.value=$("token").value.user||null,x.value.user={fullname:m.value.fullname,photo:m.value.photo}}catch(t){console.error("Fetching user failed:",t)}},te=async(t,s)=>{const d=b.value??[];if(!s.message&&s.file_url&&(s.message="Here I attached a file."),!s.message&&!s.file_url){k.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Comment message is required!"});return}d.push(s);try{const{data:r}=await E(t,{comment_json:d});k.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Order updated successfully!"}),await P(),x.value={user:{fullname:m.value.fullname,photo:m.value.photo},message:"",time:new Date().toISOString(),file_url:"",other_link:"",is_facilitator:!1}}catch(r){console.error("Updating order failed:",r),k.add({title:"Failed!",color:"red",icon:"i-heroicons-x-circle",description:"Failed to update order!"})}};return de(async()=>{$("token").value&&(await ee(),await P()),F.value=!1,window.scrollTo({top:0,behavior:"smooth"})}),(t,s)=>{const d=ne,r=_e,_=fe,y=he,h=pe,D=ge,se=ve,oe=xe;return l(),u("div",null,[ue(e("div",Ce,[o(be,{user:m.value,onLogout:K,class:"w-full"},null,8,["user"]),e("div",De,[e("div",$e,[Fe,e("div",je,[(l(!0),u(S,null,T(B(H),(n,O)=>(l(),v(r,{key:O,block:"",class:U(["py-3 px-3.5 flex justify-start bg-white hover:bg-[#FDF1EE] shadow-none",w.value===n.key?"bg-[#FDF1EE]":"bg-white"]),onClick:a=>w.value=n.key},{default:i(()=>[o(d,{name:n.icon,class:"text-2xl text-primary"},null,8,["name"]),e("span",Oe,c(n.label),1)]),_:2},1032,["class","onClick"]))),128))])]),w.value==="order-history"?(l(),u("div",Se,[e("div",Te,[o(r,{variant:"link",onClick:s[0]||(s[0]=n=>G({name:"my-client-orders"}))},{default:i(()=>[o(d,{name:"chevron-left"})]),_:1}),Ue]),(l(!0),u(S,null,T(N.value,(n,O)=>(l(),v(D,{key:O,ui:{header:{padding:"px-4 py-2 sm:px-3"},body:{padding:"px-4 py-0  sm:p-3"}},class:"p-2"},{header:i(()=>[e("div",Ie,[e("div",Ne,[o(_,{name:"i-heroicons-language"}),e("span",ze,c(n.merchant.type),1)]),e("div",Me,[o(y,{variant:"soft",color:z(n.order_status).color},{default:i(()=>[e("span",Pe,c(z(n.order_status).text),1)]),_:2},1032,["color"]),o(r,{variant:"link"},{default:i(()=>[o(d,{name:"dots",class:"text-md text-primary"})]),_:1})])])]),default:i(()=>[e("div",Ae,[e("div",Be,[e("div",Le,[o(h,{alt:n.merchant_user.fullname,src:n.merchant_user.photo,size:"xl",imgClass:"object-cover",class:"mb-2"},null,8,["alt","src"]),e("span",Ve,c(n.merchant_user.fullname),1),e("div",Ee,[e("span",Re,[g(c(n.service.name)+" Service ",1),Ye]),e("span",qe," ("+c(n.language_source.name)+" - "+c(n.language_destination.name)+") ",1)])])]),n.order_status==="completed"?(l(),v(r,{key:0,color:"primary",class:"text-white mr-4",onClick:a=>C(`https://gointering.com/api/v1/orders/${n.id}/download-result`)},{default:i(()=>[g(" Download Result ")]),_:2},1032,["onClick"])):p("",!0),n.order_status==="waitingpaid"?(l(),u("div",He,[Je,e("h6",We,c(X(n.price)),1),Ge,e("h6",Ke,[g(c(n.merchant.bank_account)+" (BCA) ",1),o(r,{size:"xs",variant:"outline",color:"blue",onClick:a=>W(n.merchant.bank_account),class:""},{default:i(()=>[o(d,{name:"copy",class:"text-lg"})]),_:2},1032,["onClick"])]),Qe])):p("",!0),n.order_status==="paid"?(l(),u("div",Xe,[Ze,et,n.meeting_link?(l(),u("div",tt,[st,o(r,{color:"primary",onClick:s[1]||(s[1]=a=>C(t.comment.file_url))},{default:i(()=>[o(_,{name:"i-heroicons-video-camera"}),g(" Open Meeting Url ")]),_:1})])):p("",!0)])):p("",!0)]),e("div",ot,[at,j.value<b.value.length?(l(),v(r,{key:0,block:"",color:"primary",variant:"soft",class:"my-4 bg-blue-100 hover:bg-blue-200",onClick:s[2]||(s[2]=a=>j.value=b.value.length)},{default:i(()=>[o(_,{name:"i-heroicons-chat-bubble-oval-left-ellipsis"}),g(" Load Previous Comments ")]),_:1})):p("",!0),(l(!0),u(S,null,T(B(J),a=>(l(),u("div",{key:a},[a.is_facilitator?(l(),u("div",nt,[o(D,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[e("div",lt,[o(h,{alt:a.user.fullname,src:a.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),e("div",it,[e("span",rt,c(a.user.fullname),1),o(y,{variant:"soft",size:"xs",color:"blue"},{default:i(()=>[ct]),_:1})])]),e("div",dt,c(a.message),1),e("div",{class:U(["flex items-center",a.file_url?"justify-between":"justify-end"])},[a.file_url?(l(),v(r,{key:0,color:"green",variant:"soft",onClick:ae=>C(a.file_url)},{default:i(()=>[o(_,{name:"i-heroicons-arrow-down-tray"}),g(" Attached File ")]),_:2},1032,["onClick"])):p("",!0),e("span",ut,c(M(new Date(a.time))),1)],2)]),_:2},1024)])):(l(),u("div",mt,[o(D,{ui:{body:{base:"w-full",padding:"p-4 sm:p-4"}},class:"flex gap-4 items-center w-ful bg-blue-50"},{default:i(()=>[e("div",_t,[o(h,{alt:a.user.fullname,src:a.user.photo,size:"md",imgClass:"object-cover"},null,8,["alt","src"]),ft]),e("div",pt,c(a.message),1),e("div",{class:U(["flex items-center",a.file_url?"justify-between":"justify-end"])},[a.file_url?(l(),v(r,{key:0,color:"green",variant:"soft",onClick:ae=>C(a.file_url)},{default:i(()=>[o(_,{name:"i-heroicons-arrow-down-tray"}),g(" Attached File ")]),_:2},1032,["onClick"])):p("",!0),e("span",ht,c(M(new Date(a.time),{addSuffix:!0})),1)],2)]),_:2},1024)]))]))),128)),o(D,{ui:{body:{base:"w-full",padding:"p-4 sm:p-2"}},class:"flex gap-4 items-center w-full"},{default:i(()=>[o(se,{modelValue:x.value.message,"onUpdate:modelValue":s[3]||(s[3]=a=>x.value.message=a),class:"w-full mb-2",placeholder:"Add Comment...",variant:"none"},null,8,["modelValue"]),e("div",gt,[o(ke,{"is-display-file":!1,accept:"*","max-size":"6291456",onFileUploaded:Z}),o(r,{color:"primary",onClick:a=>te(n.id,x.value)},{default:i(()=>[o(_,{name:"i-heroicons-paper-airplane"}),g(" Send ")]),_:2},1032,["onClick"])])]),_:2},1024)])]),_:2},1024))),128))])):p("",!0)])],512),[[me,!F.value]]),F.value?(l(),v(ye,{key:0})):p("",!0),o(oe,{isOpen:q.value,data:Y.value},null,8,["isOpen","data"])])}}};export{zt as default};
