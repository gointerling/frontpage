import{z as ge,r as m,g as he,i as ve,c as p,b as l,w as r,j as i,k as ke,o as u,d as v,a as t,F as P,x as j,m as H,t as h,l as be,A as xe,B as V,C as F,D as ye,n as W,v as we,E as Pe,s as je}from"./CxjFn7M3.js";import{_ as Se}from"./D7_MadFF.js";import{_ as Ae}from"./BUT2tR4b.js";import{_ as Ce}from"./BaFQdnXf.js";import{_ as Ue}from"./CcwNpaSy.js";import{_ as Ne}from"./CiV43fWw.js";import{_ as Ve}from"./CkOxMU80.js";import{_ as $e}from"./DiZvljQl.js";import"./6BuZ5vSY.js";import"./BPbhp0Vf.js";import"./KcFyupa-.js";import"./BL-YGieY.js";const De=()=>{const{$axios:_}=ge();return{getAdsPackages(){return _.get("/advertisement-packages")},getAdsPackageDetail(d){return _.get(`/packages/${d}`)},createAdsPackage(d){return _.post("/advertisement-packages",d)},updateAdsPackage(d,S){return _.put(`/advertisement-packages/${d}`,S)},deleteAdsPackage(d){return _.delete(`/advertisement-packages/${d}`)},getSubsPackages(){return _.get("/subscriptions-packages")},getSubsPackageDetail(d){return _.get(`/subscriptions-packages/${d}`)},createSubsPackage(d){return _.post("/subscriptions-packages",d)},updateSubsPackage(d,S){return _.put(`/subscriptions-packages/${d}`,S)},deleteSubsPackage(d){return _.delete(`/subscriptions-packages/${d}`)}}},Me={key:0,class:"text-gray-500 flex justify-center items-center h-full gap-2"},Oe={key:1,class:"w-full pt-0 p-6 flex flex-col gap-2"},Re={class:"grid grid-cols-2 gap-2"},Be={class:"flex flex-col gap-2"},He={class:"flex justify-between w-full"},Fe={class:"font-semibold flex gap-1 items-center"},Le={class:"flex justify-end"},Te={class:"flex flex-col gap-4 w-full"},Ee={class:"flex flex-col w-full"},Ie={class:"flex justify-between w-full items-center"},ze={class:"font-semibold text-xl flex items-center gap-1"},Je={class:"flex gap-1"},Ke={class:"font-semibold text-accent"},qe={class:"py-4"},Ge={class:"flex flex-col gap-2"},Qe={class:"flex justify-between w-full"},We={class:"font-semibold flex gap-1 items-center"},Xe={class:"flex justify-end"},Ye={class:"flex flex-col gap-4 w-full"},Ze={class:"flex flex-col w-full"},et={class:"flex justify-between w-full items-center"},tt={class:"font-semibold text-xl flex items-center gap-1"},st={class:"flex gap-1"},at={class:"font-semibold text-accent"},ot=t("span",{class:"font-semibold"}," Halaman : ",-1),nt={class:"pb-4"},lt={class:"flex justify-between items-center"},it={class:"font-semibold"},ct={class:"p-2"},rt={class:"flex flex-col gap-4"},ut=t("label",{for:"newName",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Name ",-1),dt=t("label",{for:"newDuration",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Duration (Month) ",-1),pt=t("label",{for:"newPrice",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Price ",-1),mt={key:0},ft=t("label",{class:"block text-sm font-medium text-gray-700 pb-2"}," Package Rule ",-1),_t={class:"flex flex-col gap-2"},gt=["value"],ht={class:"ml-2 text-gray-700"},vt={key:1},kt=t("label",{for:"newPriority",class:"block text-sm font-medium text-gray-700 pb-2"}," Priority ",-1),bt={class:"flex gap-2 items-center mb-2"},xt=t("span",{class:"block text-sm font-medium text-gray-700"}," Less ",-1),yt=t("span",{class:"block text-sm font-medium text-gray-700"}," More ",-1),wt=t("label",{for:"newRoute",class:"block text-sm font-medium text-gray-700 pb-2"}," Package Route ",-1),Pt={key:0,class:"flex flex-wrap gap-2"},jt={class:"text-sm"},St={key:1,class:"text-gray-400 py-1"},At={class:"mt-4 flex justify-end"},Lt={__name:"packages",setup(_){const{getSubsPackages:d,updateSubsPackage:S,createSubsPackage:X,deleteSubsPackage:Y,getAdsPackages:Z,createAdsPackage:ee,updateAdsPackage:te,deleteAdsPackage:se}=De(),A=m(!0),k=m(!1),$=m(!1),D=m(!1),b=m(!1),L=m({}),f=he(),M=m("subs"),T=m([]),E=m([]),I=m([{id:1,name:"Homepage",route:"/"},{id:2,name:"Packages",route:"/packages"},{id:3,name:"Facilitator",route:"/facilitators"}]),C=m([{id:1,name:"Can open a stall on the website according to the tang package they choose",rule:{name:"is_stall",value:!0}},{id:2,name:"Online lias life shop",rule:{name:"is_online_shop",value:!0}},{id:3,name:"Reviews appear",rule:{name:"is_reviewed",value:!0}},{id:4,name:"Advertised (the shop appears at the top or most recommended)",rule:{name:"is_advertised",value:!0}},{id:5,name:"Free Shipping",rule:{name:"is_free_shipping",value:!0}}]),ae=m({}),o=m({name:"",desc:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]}),z=s=>s.match(/"([^"]+)"/g).map(e=>e.replace(/"/g,"")),J=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s),U=async()=>{const{data:s}=await d();T.value=s.data.packages.map(e=>({id:e.id,name:e.name,desc:z(e.desc),duration:e.duration,price:e.price,rule_json:C.value.map(a=>{const c=z(e.desc).find(g=>g.includes(a.name));return{...a,rule:{...a.rule,value:!!c}}})})),A.value=!1},N=async()=>{const{data:s}=await Z();E.value=s.data.packages.map(e=>({id:e.id,name:e.name,route_json:e.route_json,duration:e.duration,price:e.price})),A.value=!1},K=s=>s>1?s+" Months":s+" Month",q=(s,e)=>{s==="subs"?o.value={...e,rule_json:e.rule_json.map((a,c)=>(console.log(a.rule),a.rule.value?c+1:null)),route_json:[]}:o.value={...e,rule_json:[],route_json:I.value.filter(a=>e.route_json.map(c=>c.id).includes(a.id))},O(s,!0)},O=(s,e=!1)=>{M.value=s,D.value=e,e?o.value.type=s:o.value={name:"",desc:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}],type:s},b.value=!0},w=s=>{const a=Object.keys(s)[0];return s[a][0]},G=(s,e,a,c,g)=>{L.value={title:s,content:e,confirmText:a,cancelText:c,callback:g},$.value=!0},oe=async()=>{k.value=!0,D.value?await ce():await ne()},ne=async()=>{if(o.value.type==="subs"){let s=[];const e=C.value.map(a=>{const c=o.value.rule_json.includes(a.id);return c?(s.push(a.name),{...a.rule,value:c}):{...a.rule,value:!1}});o.value.desc=JSON.stringify(s),o.value.rule_json=e,await le(o.value)}else await ie(o.value)},le=async s=>{await X(s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"New Subscription Package created successfully!"}),o.value={name:"",duration:1,price:1e4,rule_json:[]},b.value=!1,U()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{k.value=!1})},ie=async s=>{await ee(s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"New Ads Package created successfully!"}),o.value={name:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]},b.value=!1,N()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{k.value=!1})},ce=async()=>{if(o.value.type==="subs"){let s=[];const e=C.value.map(a=>{const c=o.value.rule_json.includes(a.id);return c?(s.push(a.name),{...a.rule,value:c}):{...a.rule,value:!1}});o.value.desc=JSON.stringify(s),o.value.rule_json=e,await re(o.value)}else await ue(o.value)},re=async s=>{await S(s.id,s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Subscription Package updated successfully!"}),o.value={name:"",duration:1,price:1e4,rule_json:[]},b.value=!1,U()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{k.value=!1})},ue=async s=>{await te(s.id,s).then(e=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Ads Package updated successfully!"}),o.value={name:"",duration:1,price:1e4,priority:1,rule_json:[],route_json:[{id:1,name:"Homepage",route:"/"}]},b.value=!1,N()}).catch(e=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(e.response.data.error)})}).finally(()=>{k.value=!1})},Q=async(s,e)=>{k.value=!0,ae.value={id:e},s==="subs"?await Y(e).then(a=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Package deleted successfully!"}),U()}).catch(a=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(a.response.data.error)})}).finally(()=>{k.value=!1}):await se(e).then(a=>{f.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Package deleted successfully!"}),N()}).catch(a=>{f.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:w(a.response.data.error)})}).finally(()=>{k.value=!1}),$.value=!1};return ve(()=>{A.value=!0,U(),N()}),(s,e)=>{const a=Pe,c=je,g=Se,R=Ae,de=Ce,pe=Ue,me=Ne,fe=Ve,_e=ke;return u(),p("div",null,[l(_e,{name:"admin"},{default:r(()=>[i(A)?(u(),p("div",Me,[l(a,{name:"i-ph-rocket-launch",dynamic:"",class:"text-xl text-gray-600"}),v(" Loading Packages... ")])):(u(),p("div",Oe,[t("div",Re,[t("div",Be,[l(g,{ui:{base:"w-full",body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-4"}}},{default:r(()=>[t("div",He,[t("h6",Fe,[l(a,{name:"i-heroicons-sparkles"}),v(" Subscription Packages ")]),t("div",Le,[l(c,{variant:"soft",color:"blue",onClick:e[0]||(e[0]=n=>O("subs"))},{default:r(()=>[l(a,{name:"i-heroicons-plus-circle"}),v(" Add New Package ")]),_:1})])])]),_:1}),l(g,{ui:{body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-6"}}},{default:r(()=>[t("div",Te,[(u(!0),p(P,null,j(i(T),(n,x)=>(u(),H(g,{key:x,ui:{body:{base:"w-full flex justify-between items-center flex-grow",background:"",padding:"p-2 sm:p-4"}}},{default:r(()=>[t("div",Ee,[t("div",Ie,[t("h6",ze,[l(a,{name:"i-heroicons-bolt"}),v(" "+h(n.name)+" ("+h(K(n.duration))+") ",1)]),t("div",Je,[l(c,{variant:"soft",color:"blue",onClick:y=>q("subs",n)},{default:r(()=>[l(R,{name:"edit"})]),_:2},1032,["onClick"]),l(c,{variant:"soft",color:"red",onClick:y=>{G("Hang On","Are you sure you want to delete this package ?","Delete","Cancel",()=>{Q("subs",n.id)})}},{default:r(()=>[l(a,{name:"i-heroicons-trash"})]),_:2},1032,["onClick"])])]),t("span",Ke,h(J(n.price)),1),t("ol",qe,[(u(!0),p(P,null,j(n.desc,(y,B)=>(u(),p("li",{key:B,class:"flex gap-2 items-start"},[l(R,{name:"check-package",class:"pt-1"}),v(" "+h(y),1)]))),128))])])]),_:2},1024))),128))])]),_:1})]),t("div",Ge,[l(g,{ui:{base:"w-full",body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-4"}}},{default:r(()=>[t("div",Qe,[t("h6",We,[l(a,{name:"i-heroicons-megaphone"}),v(" Ads Packages ")]),t("div",Xe,[l(c,{variant:"soft",color:"blue",onClick:e[1]||(e[1]=n=>O("ads"))},{default:r(()=>[l(a,{name:"i-heroicons-plus-circle"}),v(" Add New Package ")]),_:1})])])]),_:1}),l(g,{ui:{body:{base:"flex justify-between items-center",background:"",padding:"p-2 sm:p-6"}}},{default:r(()=>[t("div",Ye,[(u(!0),p(P,null,j(i(E),(n,x)=>(u(),H(g,{key:x,ui:{body:{base:"w-full flex justify-between items-center flex-grow",background:"",padding:"p-2 sm:p-4"}}},{default:r(()=>[t("div",Ze,[t("div",et,[t("h6",tt,[l(a,{name:"i-heroicons-bolt"}),v(" "+h(n.name)+" ("+h(K(n.duration))+") ",1)]),t("div",st,[l(c,{variant:"soft",color:"blue",onClick:y=>q("ads",n)},{default:r(()=>[l(R,{name:"edit"})]),_:2},1032,["onClick"]),l(c,{variant:"soft",color:"red",onClick:y=>{G("Hang On","Are you sure you want to delete this package ?","Delete","Cancel",()=>{Q("ads",n.id)})}},{default:r(()=>[l(a,{name:"i-heroicons-trash"})]),_:2},1032,["onClick"])])]),t("span",at,h(J(n.price)),1),ot,t("ol",nt,[(u(!0),p(P,null,j(n.route_json,(y,B)=>(u(),p("li",{key:B,class:"flex gap-2 items-center"},[l(a,{name:"i-heroicons-globe-alt",class:"pt-1"}),v(" "+h(y.name),1)]))),128))])])]),_:2},1024))),128))])]),_:1})])]),l(fe,{modelValue:i(b),"onUpdate:modelValue":e[9]||(e[9]=n=>be(b)?b.value=n:null),ui:{width:"w-full sm:max-w-2xl"},"prevent-close":""},{default:r(()=>[l(g,null,{default:r(()=>[t("div",lt,[t("h6",it,h(i(D)?"Edit":"Add New")+" Package ",1),l(c,{variant:"soft",color:"red",icon:"i-heroicons-x-circle",onClick:e[2]||(e[2]=n=>b.value=!1)})]),t("div",ct,[t("form",{onSubmit:xe(oe,["prevent"])},[t("div",rt,[t("div",null,[ut,V(t("input",{type:"text",id:"newName",placeholder:"Package Name","onUpdate:modelValue":e[3]||(e[3]=n=>i(o).name=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).name]])]),t("div",null,[dt,V(t("input",{type:"number",id:"newDuration",placeholder:"Package Duration","onUpdate:modelValue":e[4]||(e[4]=n=>i(o).duration=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).duration]])]),t("div",null,[pt,V(t("input",{type:"number",id:"newPrice",placeholder:"Package Price","onUpdate:modelValue":e[5]||(e[5]=n=>i(o).price=n),class:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md p-2"},null,512),[[F,i(o).price]])]),i(M)==="subs"?(u(),p("div",mt,[ft,t("div",_t,[(u(!0),p(P,null,j(i(C),n=>(u(),p("label",{key:n.id,class:"flex gap-1 py-[0.1em] w-fit"},[V(t("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-primary rounded-md",value:n.id,"onUpdate:modelValue":e[6]||(e[6]=x=>i(o).rule_json=x)},null,8,gt),[[ye,i(o).rule_json]]),t("span",ht,h(n.name)+".",1)]))),128))])])):W("",!0),i(M)==="ads"?(u(),p("div",vt,[kt,t("div",bt,[xt,l(de,{modelValue:i(o).priority,"onUpdate:modelValue":e[7]||(e[7]=n=>i(o).priority=n),step:1,min:1,max:3},null,8,["modelValue"]),yt]),wt,l(me,{modelValue:i(o).route_json,"onUpdate:modelValue":e[8]||(e[8]=n=>i(o).route_json=n),searchable:"",options:i(I),placeholder:"Select Ads Show Page","option-attribute":"name",multiple:"",trailing:"",by:"id",ui:{base:"w-full py-2 outline-none border-none",ring:"ring-0"}},{default:r(()=>[l(c,{color:"gray",class:"flex-1 justify-between"},{default:r(()=>[i(o).route_json.length>0?(u(),p("div",Pt,[(u(!0),p(P,null,j(i(o).route_json,(n,x)=>(u(),H(pe,{key:x,color:"blue",variant:"soft"},{default:r(()=>[t("span",jt,h(n.name),1)]),_:2},1024))),128))])):(u(),p("span",St," Select Ads Show Page ")),l(a,{name:"i-heroicons-chevron-down-20-solid",class:we(["w-5 h-5 transition-transform text-gray-400 dark:text-gray-500",[s.open&&"transform rotate-90"]])},null,8,["class"])]),_:1})]),_:1},8,["modelValue","options"])])):W("",!0)]),t("div",At,[l(c,{loading:i(k),type:"submit",variant:"soft",color:"blue"},{default:r(()=>[v(" Save ")]),_:1},8,["loading"])])],32)])]),_:1})]),_:1},8,["modelValue"])]))]),_:1}),l($e,{isOpen:i($),data:i(L)},null,8,["isOpen","data"])])}}};export{Lt as default};
