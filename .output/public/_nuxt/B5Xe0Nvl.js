import{_ as D}from"./C57DnwrD.js";import{y as M,g as O,r as u,o,c as s,a,b as g,t as f,q as F,F as I,m as P}from"./BMWu61xc.js";const V=()=>{const{$axios:i}=M();return{uploadFile(l,y){const c=new FormData;return c.append("file",l),c.append("file_name",y),i.post("/files",c)},deleteFile(l){return i.delete(`/files/${l}`)}}},A={class:"file-upload"},T=["accept"],j={key:0,class:"px-4 py-2 border border-primary rounded hover:bg-primary flex items-center gap-1 group transition duration-200"},q=a("span",{class:"text-primary group-hover:text-white transition duration-200"}," Uploading... ",-1),L=[q],R={key:1},G={class:"text-primary group-hover:text-white transition duration-200"},H={key:1,class:"flex flex-wrap gap-2"},J=["onClick"],K={class:"absolute top-2 right-2 p-1 text-white bg-red-500 rounded-full opacity-0 group-hover:opacity-100 transition duration-200"},Q={class:"text-primary transition duration-200 group-hover:text-white"},W={class:"text-primary group-hover:text-white transition duration-200"},X={key:2,class:"mt-2 text-red-500 text-xs"},ee={__name:"MultipleFileUpload",props:{title:{type:String,default:"Files"},accept:{type:String,default:""},maxSize:{type:Number,default:0}},emits:["fileUploaded"],setup(i,{emit:l}){const{uploadFile:y,deleteFile:c}=V(),v=i,p=O(),z=l,x=u(null),n=u([]),h=u(""),_=u([]),b=u(!1),k=()=>{x.value.click()},C=()=>{const e=Array.from(x.value.files);let r=0;e.forEach(t=>{r+=t.size,n.value.push(t.name)}),v.maxSize>v.maxSize?(h.value=`Total file size exceeds the limit of ${N(v.maxSize/1024/1024,2)} MB.`,n.value.splice(-e.length,e.length)):(h.value="",$(e))},E=async e=>{const r=_.value.splice(e,1)[0];await B(r),n.value.splice(e,1)},N=(e,r)=>+(Math.round(e+"e"+r)+"e-"+r),$=e=>{b.value=!0;const r=e.map(t=>y(t));Promise.all(r).then(t=>{b.value=!1,t.forEach(d=>{_.value.push(d.data.data.fileRecord);const m=_.value.map(U=>U.url);w(m)}),p.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Files uploaded successfully!"})}).catch(t=>{console.error(t),p.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:S(t.response.data.error)})})},B=async e=>{e&&await c(e.id).then(()=>{w(""),p.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"File deleted successfully!"})}).catch(r=>{console.error(r),p.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:S(r.response.data.error)})})},w=e=>{z("fileUploaded",e)},S=e=>e.errors?e.errors[Object.keys(e.errors)[0]][0]:e.message;return(e,r)=>{const t=D;return o(),s("div",A,[a("input",{ref_key:"fileInput",ref:x,type:"file",accept:i.accept,multiple:"",class:"hidden",onChange:C},null,40,T),b.value?(o(),s("button",j,L)):(o(),s("div",R,[n.value.length===0?(o(),s("button",{key:0,onClick:k,class:"px-4 py-2 border border-primary rounded hover:bg-primary flex items-center gap-1 group transition duration-200"},[g(t,{name:"file-add",class:"text-primary group-hover:text-white transition duration-200"}),a("span",G,f(i.title),1)])):F("",!0),n.value.length>0?(o(),s("div",H,[(o(!0),s(I,null,P(n.value,(d,m)=>(o(),s("div",{key:m,class:"relative group"},[a("button",{onClick:U=>E(m),class:"relative group flex items-center gap-1 px-4 py-2 border border-primary bg-slate-100 rounded transition duration-200 hover:bg-red-500"},[a("div",K,[g(t,{name:"circle-x",class:"h-4 w-4"})]),g(t,{name:"file",class:"text-primary transition duration-200 group-hover:text-white"}),a("span",Q,f(d.length>5?d.substring(0,5)+"...":d),1)],8,J)]))),128)),a("button",{onClick:k,class:"px-4 py-2 border border-primary rounded hover:bg-primary flex items-center gap-1 group transition duration-200"},[g(t,{name:"file-add",class:"text-primary group-hover:text-white transition duration-200"}),a("span",W,f(i.title),1)])])):F("",!0)])),h.value?(o(),s("p",X,f(h.value),1)):F("",!0)])}}};export{ee as _,V as u};
