import{_ as O}from"./BxGqzEK9.js";import{g as I,r as l,o,c as s,a,b as h,t as m,n as x,F as P,x as V}from"./DMHnhahR.js";import{u as $}from"./CpkR63Mp.js";const D={class:"file-upload"},T=["accept"],j={key:0,class:"px-4 py-2 border border-primary rounded-lg hover:bg-primary flex items-center gap-1 group transition duration-200"},A=a("span",{class:"text-primary group-hover:text-white transition duration-200"}," Uploading... ",-1),L=[A],R={key:1},q={class:"text-primary group-hover:text-white transition duration-200"},G={key:1,class:"flex flex-wrap gap-2"},H=["onClick"],J={class:"absolute top-2 right-2 p-1 text-white bg-red-500 rounded-full opacity-0 group-hover:opacity-100 transition duration-200"},K={class:"text-primary transition duration-200 group-hover:text-white"},Q={class:"text-primary group-hover:text-white transition duration-200"},W={key:2,class:"mt-2 text-red-500 text-xs"},ee={__name:"MultipleFileUpload",props:{title:{type:String,default:"Files"},accept:{type:String,default:""},maxSize:{type:Number,default:0}},emits:["fileUploaded"],setup(c,{emit:w}){const{uploadFile:S,deleteFile:U}=$(),g=c,d=I(),z=w,f=l(null),i=l([]),u=l(""),v=l([]),y=l(!1),_=()=>{f.value.click()},C=()=>{const e=Array.from(f.value.files);let r=0;e.forEach(t=>{r+=t.size,i.value.push(t.name)}),g.maxSize>g.maxSize?(u.value=`Total file size exceeds the limit of ${B(g.maxSize/1024/1024,2)} MB.`,i.value.splice(-e.length,e.length)):(u.value="",M(e))},E=async e=>{const r=v.value.splice(e,1)[0];await N(r),i.value.splice(e,1)},B=(e,r)=>+(Math.round(e+"e"+r)+"e-"+r),M=e=>{y.value=!0;const r=e.map(t=>S(t));Promise.all(r).then(t=>{y.value=!1,t.forEach(n=>{v.value.push(n.data.data.fileRecord);const p=v.value.map(F=>F.url);b(p)}),d.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"Files uploaded successfully!"})}).catch(t=>{console.error(t),d.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:k(t.response.data.error)})})},N=async e=>{e&&await U(e.id).then(()=>{b(""),d.add({title:"Success!",color:"green",icon:"i-heroicons-check-circle",description:"File deleted successfully!"})}).catch(r=>{console.error(r),d.add({title:"Uh Oh!",color:"red",icon:"i-heroicons-exclamation-triangle",description:k(r.response.data.error)})})},b=e=>{z("fileUploaded",e)},k=e=>e.errors?e.errors[Object.keys(e.errors)[0]][0]:e.message;return(e,r)=>{const t=O;return o(),s("div",D,[a("input",{ref_key:"fileInput",ref:f,type:"file",accept:c.accept,multiple:"",class:"hidden",onChange:C},null,40,T),y.value?(o(),s("button",j,L)):(o(),s("div",R,[i.value.length===0?(o(),s("button",{key:0,onClick:_,class:"px-4 py-2 border border-primary rounded-lg hover:bg-primary flex items-center gap-1 group transition duration-200"},[h(t,{name:"file-add",class:"text-primary group-hover:text-white transition duration-200"}),a("span",q,m(c.title),1)])):x("",!0),i.value.length>0?(o(),s("div",G,[(o(!0),s(P,null,V(i.value,(n,p)=>(o(),s("div",{key:p,class:"relative group"},[a("button",{onClick:F=>E(p),class:"relative group flex items-center gap-1 px-4 py-2 border border-primary bg-slate-100 rounded-lg transition duration-200 hover:bg-red-500"},[a("div",J,[h(t,{name:"circle-x",class:"h-4 w-4"})]),h(t,{name:"file",class:"text-primary transition duration-200 group-hover:text-white"}),a("span",K,m(n.length>5?n.substring(0,5)+"...":n),1)],8,H)]))),128)),a("button",{onClick:_,class:"px-4 py-2 border border-primary rounded-lg hover:bg-primary flex items-center gap-1 group transition duration-200"},[h(t,{name:"file-add",class:"text-primary group-hover:text-white transition duration-200"}),a("span",Q,m(c.title),1)])])):x("",!0)])),u.value?(o(),s("p",W,m(u.value),1)):x("",!0)])}}};export{ee as _};
